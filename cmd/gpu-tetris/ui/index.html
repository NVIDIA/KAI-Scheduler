<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>K8s GPU Tetris</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <header class="header">
    <div class="title">K8s GPU Tetris</div>
    <div class="meta" id="meta">Loadingâ€¦</div>
  </header>

  <div class="layout">
    <aside class="sidebar">
      <div class="section-title">Create</div>
      <div class="tabs" id="resourceTypeTabs">
        <button type="button" class="tab active" data-type="pod">Pod</button>
        <button type="button" class="tab" data-type="deployment">Dep</button>
        <button type="button" class="tab" data-type="job">Job</button>
        <button type="button" class="tab" data-type="queue">Q</button>
        <button type="button" class="tab" data-type="topology">Topo</button>
      </div>
      <form id="createResource" class="form">
        <input type="hidden" name="resourceType" id="resourceTypeInput" value="pod" />

        <!-- Pod-specific fields -->
        <div id="podFields">
          <label class="label">Namespace
            <input class="input" name="namespace" placeholder="default" />
          </label>
          <label class="label">Name
            <input class="input" name="podName" placeholder="(auto)" />
          </label>
          <label class="label">Queue
            <select class="input" name="queue" id="queueSelect">
              <option value="">-- Select queue --</option>
            </select>
          </label>
          <label class="label">Mode
            <select class="input" name="mode">
              <option value="whole">Whole GPU</option>
              <option value="fraction">GPU Fraction</option>
              <option value="memory">GPU Memory (MiB)</option>
            </select>
          </label>
          <label class="label">GPU Count
            <input class="input" name="gpuCount" type="number" min="1" value="1" />
          </label>
          <label class="label">GPU Fraction
            <input class="input" name="gpuFraction" type="number" min="0.01" max="0.99" step="0.01" value="0.5" />
          </label>
          <label class="label">Fraction #Devices
            <input class="input" name="fractionNumDevices" type="number" min="1" value="1" />
          </label>
          <label class="label">GPU Memory (MiB)
            <input class="input" name="gpuMemoryMiB" type="number" min="1" value="2000" />
          </label>
          <label class="label">Image
            <input class="input" name="image" placeholder="busybox:1.36" />
          </label>
        </div>

        <!-- Deployment-specific fields -->
        <div id="deploymentFields" style="display: none;">
          <label class="label">Namespace
            <input class="input" name="deploymentNamespace" placeholder="default" />
          </label>
          <label class="label">Name
            <input class="input" name="deploymentName" placeholder="(auto)" />
          </label>
          <label class="label">Replicas
            <input class="input" name="replicas" type="number" min="1" value="1" />
          </label>
          <label class="label">Queue
            <select class="input" name="deploymentQueue" id="deploymentQueueSelect">
              <option value="">-- Select queue --</option>
            </select>
          </label>
          <label class="label">Mode
            <select class="input" name="deploymentMode">
              <option value="whole">Whole GPU</option>
              <option value="fraction">GPU Fraction</option>
              <option value="memory">GPU Memory (MiB)</option>
            </select>
          </label>
          <label class="label">GPU Count
            <input class="input" name="deploymentGpuCount" type="number" min="1" value="1" />
          </label>
          <label class="label">GPU Fraction
            <input class="input" name="deploymentGpuFraction" type="number" min="0.01" max="0.99" step="0.01" value="0.5" />
          </label>
          <label class="label">Fraction #Devices
            <input class="input" name="deploymentFractionNumDevices" type="number" min="1" value="1" />
          </label>
          <label class="label">GPU Memory (MiB)
            <input class="input" name="deploymentGpuMemoryMiB" type="number" min="1" value="2000" />
          </label>
          <label class="label">Image
            <input class="input" name="deploymentImage" placeholder="busybox:1.36" />
          </label>
        </div>

        <!-- Job-specific fields -->
        <div id="jobFields" style="display: none;">
          <label class="label">Namespace
            <input class="input" name="jobNamespace" placeholder="default" />
          </label>
          <label class="label">Name
            <input class="input" name="jobName" placeholder="(auto)" />
          </label>
          <label class="label">Parallelism
            <input class="input" name="parallelism" type="number" min="1" value="1" />
          </label>
          <label class="label">Completions
            <input class="input" name="completions" type="number" min="1" value="1" />
          </label>
          <label class="label">Queue
            <select class="input" name="jobQueue" id="jobQueueSelect">
              <option value="">-- Select queue --</option>
            </select>
          </label>
          <label class="label">Mode
            <select class="input" name="jobMode">
              <option value="whole">Whole GPU</option>
              <option value="fraction">GPU Fraction</option>
              <option value="memory">GPU Memory (MiB)</option>
            </select>
          </label>
          <label class="label">GPU Count
            <input class="input" name="jobGpuCount" type="number" min="1" value="1" />
          </label>
          <label class="label">GPU Fraction
            <input class="input" name="jobGpuFraction" type="number" min="0.01" max="0.99" step="0.01" value="0.5" />
          </label>
          <label class="label">Fraction #Devices
            <input class="input" name="jobFractionNumDevices" type="number" min="1" value="1" />
          </label>
          <label class="label">GPU Memory (MiB)
            <input class="input" name="jobGpuMemoryMiB" type="number" min="1" value="2000" />
          </label>
          <label class="label">Image
            <input class="input" name="jobImage" placeholder="busybox:1.36" />
          </label>
        </div>

        <!-- Queue-specific fields -->
        <div id="queueFields" style="display: none;">
          <label class="label">Name
            <input class="input" name="queueName" placeholder="my-queue" />
          </label>
          <label class="label">Display Name
            <input class="input" name="displayName" placeholder="(optional)" />
          </label>
          <label class="label">Parent Queue
            <select class="input" name="parentQueue" id="parentQueueSelect">
              <option value="">-- None (root queue) --</option>
            </select>
          </label>
          <label class="label">Priority
            <input class="input" name="priority" type="number" value="100" />
          </label>
          <label class="label">GPU Quota
            <input class="input" name="gpuQuota" type="number" step="0.1" min="0" placeholder="(optional)" />
          </label>
        </div>

        <!-- Topology-specific fields -->
        <div id="topologyFields" style="display: none;">
          <label class="label">Topology Name
            <input class="input" name="topologyName" placeholder="gpu-tetris-topology" />
          </label>
          <label class="label">Levels (node label keys)
            <input class="input" name="levels" placeholder="topology.kubernetes.io/zone,kubernetes.io/hostname" />
          </label>
          <label class="label">Node assignments (one per line)
            <textarea class="input" name="assignments" rows="6" placeholder="node-a zone-a node-a\nnode-b zone-b node-b"></textarea>
          </label>
        </div>

        <button class="button primary" type="submit">Create</button>
        <div class="form-status" id="createResourceStatus"></div>

        <button class="button danger" id="deleteTetrisPods" type="button">Delete all tetris resources</button>
        <div class="form-status" id="deleteTetrisPodsStatus"></div>
      </form>

      <div class="section-title">Pending Pods</div>
      <div id="pending" class="pending"></div>

      <div class="section-title">Queues</div>
      <div id="queues"></div>

      <div class="section-title">Topology</div>
      <div id="topology"></div>
    </aside>

    <main class="main">
      <div class="section-title">Nodes</div>
      <div id="nodes"></div>
    </main>
  </div>

  <script src="/app.js"></script>
</body>
</html>
